files:
    "/sbin/appstart":
        mode: "000755"
        owner: webapp
        group: webapp
        content: |
            #!/usr/bin/env bash
            JAR_PATH=/var/app/current/application.jar

            # Check if the JAR file exists
            if [ ! -f "$JAR_PATH" ]; then
                echo "JAR file not found: $JAR_PATH"
                exit 1
            fi

            # Run app
            pkill -f 'java -Dfile.encoding=UTF-8 -jar'
            nohup java -Dfile.encoding=UTF-8 -jar $JAR_PATH > /var/log/app.log 2>&1 &
